#!/usr/bin/env bash
set -euo pipefail
cd /workspace/ai-infra-demo
source .venv/bin/activate
export HF_HOME=/workspace/hf_cache
export TRANSFORMERS_CACHE=/workspace/hf_cache
mkdir -p /workspace/logs /workspace/hf_cache
nohup uvicorn server.app:app --host 0.0.0.0 --port 8000 > /workspace/logs/uvicorn.log 2>&1 &
echo $! > /workspace/logs/uvicorn.pid
echo "Started uvicorn pid=$(cat /workspace/logs/uvicorn.pid)"
